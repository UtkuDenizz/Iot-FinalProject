ğŸ  Smart Home IoT System
IoT & Cloud Computing Final Project â€“ Collegium Da Vinci

A fully functional cloud-enabled Smart Home IoT System designed for real-time monitoring and remote control of devices.
The project integrates:

IoT device simulation

MQTT messaging

Cloud-hosted FastAPI backend

Azure PostgreSQL database

Swagger & Postman testing interfaces

The backend runs on Azure App Service, the MQTT Broker on Azure VM, and all data is securely stored in Azure PostgreSQL.

ğŸš€ Project Overview
âœ” IoT Device Simulator

Sends temperature & humidity data every 5 seconds

Receives device commands (light_on, light_off) via MQTT

âœ” MQTT Broker (Mosquitto on Azure VM)

Handles all IoT messaging

API subscribes to sensor data

Device simulator subscribes to commands

âœ” Cloud Backend â€” FastAPI (Azure App Service)

REST API for device control & data management

Publishes MQTT commands

JWT authentication

Saves all sensor data into Azure PostgreSQL

âœ” Azure PostgreSQL Flexible Server

Stores all sensor readings

SSL-secured database connection

Accessible only through API

âœ” Swagger API Documentation (Cloud)

ğŸ”— https://smart-home-api-fjegf4a9hce4fwcz.francecentral-01.azurewebsites.net/docs

âœ” Postman Collection

Used to test:

Login

Retrieve data

Add data manually

Send MQTT commands

ğŸ§± System Architecture (High-Level Overview)
IoT Device â†’ MQTT Broker (Azure VM) â†’ Cloud API (Azure App Service) â†’ Azure PostgreSQL

ğŸ–¥ IoT Device Simulator

Publishes sensor data â†’ smart_home/sensor_data

Subscribes to â†’ smart_home/commands/device_001

â˜ MQTT Broker (Azure VM)

Routes data between devices and backend

ğŸŒ FastAPI Backend (Cloud)

Exposes REST endpoints

Handles JWT auth

Saves incoming MQTT data

Sends commands to devices

ğŸ—„ Azure PostgreSQL

Stores all sensor data in sensor_data table

ğŸ§© C4 Architecture Diagrams

âœ” System Context Diagram
âœ” Container Diagram

Both diagrams are included in the repository and document how cloud, IoT, and software layers interact.

ğŸ” Authentication

The API uses JWT-based authentication.

Login
POST /login
{
  "username": "admin",
  "password": "admin123"
}

Use the token in all protected endpoints:
Authorization: Bearer <token>

ğŸ“¡ Main API Endpoints
Method	Endpoint	Description
GET	/	Health check
POST	/login	Obtain JWT token
GET	/data	Get all sensor data
POST	/data	Insert data manually
POST	/command/{device_id}	Send MQTT command

Full docs:
ğŸ”— https://smart-home-api-fjegf4a9hce4fwcz.francecentral-01.azurewebsites.net/docs

ğŸ–¥ï¸ Running the Device Simulator

Open terminal:

cd device
python simple_device.py


The device will:

Publish sensor data

Listen for MQTT commands

Send data to the cloud API

Example output:

[MQTT PUBLISHED] {temperature: 24.8, humidity: 55.1}
[API] 200 OK
[COMMAND RECEIVED] light_on

ğŸ—„ Database Schema (Azure PostgreSQL)

Table: sensor_data

Column	Type	Description
id	SERIAL PRIMARY KEY	Unique row ID
device_id	VARCHAR	Device identifier
temperature	FLOAT	Temperature reading
humidity	FLOAT	Humidity reading
timestamp	TIMESTAMP	Time of reading
ğŸ“¬ Postman Collection

Included as:
ğŸ“ postman/SmartHome.postman_collection.json

Collection includes:

Login request

Retrieve sensor data

Insert manual data

Send MQTT commands

ğŸ§­ Business Context & User Stories
Target Users

Smart home owners

Developers

System administrators

User Stories

1ï¸âƒ£ As a user, I want to monitor real-time sensor updates so I can understand conditions at home.
2ï¸âƒ£ As a user, I want to control home devices remotely so I can turn lights on/off from anywhere.
3ï¸âƒ£ As a business owner, I want historical data stored so I can analyze trends.
4ï¸âƒ£ As a developer, I want clear API documentation for integrations.

ğŸ’° Cost Calculation (Task Completed)

The repository includes:

ğŸ“„ cost_calculation.md
â†’ Contains estimated Azure cost for 1000 devices and 300 users, using:

Azure App Service

Azure VM (MQTT Broker)

Azure PostgreSQL

Outbound network traffic

ğŸ§ª Testing Tools

âœ” Cloud Swagger UI
âœ” Postman
âœ” IoT device simulator (Python)

ğŸ‘¨â€ğŸ’» Authors

Deniz Utku Ã‡elebi
Utku Deniz Duman
Collegium Da Vinci â€“ IoT & Cloud Computing Project (2025)